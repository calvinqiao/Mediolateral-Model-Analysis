function [pelvisAng] = leg2PelvisAng(m, legAng, lA) % la: ankle distance
%     A = 16*m.HJCDistance^2*m.legLength^2 ...
%        -4*m.HJCDistance^4-4*la^4 ... 
%        +8*m.HJCDistance^2*la^2; %0th term 
%     B = 16*m.legLength*la^3 ...
%        -16*m.HJCDistance^2*m.legLength*la; %1st-order term
%     C = -16*m.legLength^2*la^2; %2nd-order term
% 
%     top = 4*cos(legAng)*m.legLength*m.HJCDistance...
%          +sqrt(A+B*sin(legAng)+C*sin(legAng)^2);
     
     temp = 16*m.HJC_distance^2*m.leg_len^2 - ...
            4*m.HJC_distance^4 - 4*lA^4 + ...
            8*m.HJC_distance^2*lA^2 + ...
            16*sin(legAng)*m.leg_len*lA^3 - ...
            16*sin(legAng)*m.HJC_distance^2*lA*m.leg_len - ...
            16*sin(legAng)*sin(legAng)*m.leg_len^2*lA^2;
     
    top = 4*cos(legAng)*m.leg_len*m.HJC_distance - sqrt(temp);
    
%     bottom = 2*((m.HJCDistance+la)^2 ...
%                 -2*(m.HJCDistance+la)*m.legLength*sin(legAng));
    bottom = 2*(m.HJC_distance^2 + lA^2 - ...
                2*sin(legAng)*m.HJC_distance*m.leg_len + ...
                2*m.HJC_distance*lA - ...
                2*sin(legAng)*m.leg_len*lA);
    pelvisAng = atan(top/bottom);
end

%         denom = 2*(measures.HJCDistance^2 + ankleDistance^2 - ...
%                 2*sin(legAngExact)*measures.HJCDistance*measures.legLength ...
%                 + 2*measures.HJCDistance*ankleDistance - ...
%                 2*sin(legAngExact)*measures.legLength*ankleDistance);
%         numRad = 16*measures.HJCDistance^2*measures.legLength^2 - ...
%                  4*measures.HJCDistance^4 - 4*ankleDistance^4 + ...
%                  8*measures.HJCDistance^2*ankleDistance^2 ...
%                  + 16*sin(legAngExact)*measures.legLength*ankleDistance^3 ...
%                  - 16*sin(legAngExact)*measures.HJCDistance^2*ankleDistance*measures.legLength ...
%                  - 16*sin(legAngExact)*sin(legAngExact)*measures.legLength^2*ankleDistance^2;
%         numer = 4*cos(legAngExact)*measures.legLength*measures.HJCDistance - sqrt(numRad);
%         hipAngExact = 2*atan(numer/denom);